<!-- OUTER WRAPPER -->
<div class="bg-zinc-100 pt-4 px-0 sm:py-12 sm:px-6 lg:px-2">

  <!-- CARD WRAPPER -->
  <div class="mt-2 w-full rounded-3xl bg-white p-8 sm:mt-2 sm:w-1/2 sm:mx-auto sm:rounded-3xl">
<% if location.persisted? %>
  <div class="flex justify-end space-x-2 mb-4">
    <%= link_to "Areas", location_areas_path(location), class: "px-3 py-1.5 text-xs text-violet-500 bg-white border border-violet-500 rounded-3xl hover:bg-violet-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-violet-500" %>
    <% if location.archived? %>
      <%= button_to "Restore", restore_location_path(location), method: :patch, class: "px-3 py-1.5 text-xs text-white bg-green-600 rounded-3xl hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500" %>
    <% else %>
      <%= button_to "Archive", archive_location_path(location), method: :patch, class: "px-3 py-1.5 text-xs bg-white text-red-600 border border-red-600 rounded-3xl hover:bg-red-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500", data: { confirm: "Are you sure you want to archive this location?" } %>
    <% end %>
  </div>
<% end %>
    <div class="text-center mb-8">
      <% if location.persisted? %>
        <span class="text-4xl font-bold text-gray-800">Edit</span>
        <span class="text-4xl font-bold text-violet-700">client</span>
        <p class="mt-6 text-gray-600">Update this clientâ€™s details.</p>
      <% else %>
        <span class="text-4xl font-bold text-gray-800">New</span>
        <span class="text-4xl font-bold text-violet-700">client</span>
        <p class="mt-6 text-gray-600">Please add your details.</p>
      <% end %>
    </div>

    <%= form_with(model: location, html: { class: "space-y-6" }) do |form| %>
      <% if location.errors.any? %>
        <div class="rounded-xl border border-red-200 bg-red-50 p-4 text-red-800">
          <p class="font-semibold"><%= pluralize(location.errors.count, "error") %> prevented this location from being saved:</p>
          <ul class="mt-2 list-disc pl-5">
            <% location.errors.full_messages.each do |msg| %>
              <li><%= msg %></li>
            <% end %>
          </ul>
        </div>
      <% end %>

      <!-- Basic Info -->
      <div>
        <%= form.label :name, class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_field :name, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500", placeholder: "First name and Last name" %>
      </div>

      <div>
        <%= form.label :address, class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_field :address, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500", placeholder: "Street, Suburb, State" %>
      </div>

      <!-- Contact / Admin Details -->
      <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
        <div>
          <%= form.label :email, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.email_field :email, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500", placeholder: "location@example.com" %>
        </div>
        <div>
          <%= form.label :phone, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_field :phone, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500", placeholder: "Contact number" %>
        </div>
        <div>
          <%= form.label :date_of_birth, "Date of Birth", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.date_field :date_of_birth, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
        </div>
        <div>
          <%= form.label :gender, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_field :gender, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
        </div>
        <div>
          <%= form.label :ndis_number, "NDIS Number", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_field :ndis_number, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
        </div>
        <div>
          <%= form.label :representative_name, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_field :representative_name, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
        </div>
        <div>
          <%= form.label :representative_email, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.email_field :representative_email, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500", placeholder: "rep@example.com" %>
        </div>
        <div>
          <%= form.label :funding, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.select :funding,
                [["Plan managed", "Plan managed"], ["Agency managed", "Agency managed"], ["Self managed", "Self managed"]],
                { selected: "Plan managed" },
                class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
        </div>
        <div>
          <%= form.label :plan_manager_email, "Plan Manager Email", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.email_field :plan_manager_email, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
        </div>
        
        
        
        <div>
          <%= form.label :lives_with, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_field :lives_with, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500", placeholder: "e.g. Parents" %>
        </div>
        <div>
          <%= form.label :pets, class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_field :pets, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500", placeholder: "e.g. Dog (friendly)" %>
        </div>
        
      </div>

      <!-- Long Text Sections -->
      <div>
        <%= form.label :interview_info, "Interview Info", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_area :interview_info, rows: 4, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
      </div>
      <div>
        <%= form.label :schedule_info, "Schedule Info", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_area :schedule_info, rows: 4, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
        <details class="mt-3 text-xs text-gray-600">
          <summary class="cursor-pointer text-violet-700 hover:underline inline">Hint</summary>
          <div class="mt-2 relative border border-gray-200 rounded-md p-3 pt-8 pr-8 bg-white">
            <button type="button" title="Copy hint"
                    class="mb-8 absolute top-2 right-0 text-gray-500 hover:text-violet-700"
                    onclick="navigator.clipboard.writeText(document.getElementById('schedule_hint').innerHTML).then(() => { this.textContent = 'Copied'; this.classList.remove('hover:text-violet-700'); this.classList.add('text-green-600'); });">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75" />
              </svg>
            </button>
            <div id="schedule_hint">
              01_004_0107_1_1 Assistance with Personal Domestic Activities : $59.06 per hour<br><br>
              Provision of support to assist a participant with domestic duties and cleaning of the household. Cost of Service Delivery as per NDIS pricing arrangements are attached below.<br>
              <br>
              Weekly<br>
              Thursday 7am - 11am<br>
              <br>
              01_004_0107_1_1 Assistance with Personal Domestic Activities: 4 hours<br>
              01_799_0107_1_1 Provider Travel - Non-Labour Costs: 0.25 hours<br>
            </div>
          </div>
        </details>
      </div>
      <div>
        <%= form.label :activities_of_interest, "Activities of Interest", class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_area :activities_of_interest, rows: 4, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
      </div>
      <div>
        <%= form.label :tasks, class: "block text-sm font-medium text-gray-700 mb-1" %>
        <%= form.text_area :tasks, rows: 4, class: "block w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-xl focus:ring-violet-500 focus:border-violet-500" %>
      </div>

      <% if location.persisted? %>
        <!-- Areas (nested) -->
        <div class="pt-2 border-t">
          <h3 class="text-lg font-semibold text-gray-700 mt-6">Areas</h3>
          <div id="areas" class="mt-4 space-y-6">
            <%= form.fields_for :areas do |area_form| %>
              <%= render 'locations/area_fields', form: area_form %>
            <% end %>
          </div>
          <%# hook for dynamic add/remove via JS if needed %>
        </div>
      <% end %>

      <!-- Submit -->
      <div class="pt-2">
        <%= form.submit (location.persisted? ? "Update Location" : "Create Location"), class: "w-full bg-violet-600 hover:bg-violet-700 text-white font-semibold py-3 px-4 rounded-3xl shadow-lg transition-transform transform hover:scale-105" %>
      </div>
    <% end %>
  </div>
</div>

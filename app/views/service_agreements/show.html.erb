<% content_for :title, @agreement.title %>

<div class="bg-zinc-100 min-h-screen">
  <section class="container mx-auto px-4 py-10">
    <div class="w-full max-w-3xl mx-auto">
      <div class="bg-white rounded-2xl p-6">
        <div class="flex items-center justify-between mb-4">
          <h1 class="text-2xl font-bold text-gray-800"><%= @agreement.title %></h1>
        </div>

        <article class="prose max-w-none">
          <div class="text-gray-800">
            <%= render_agreement_html(@agreement, user: nil, acceptance: nil, location: @location) %>
          </div>
        </article>

        <% if @acceptance.signed_at.blank? %>
          <hr class="my-6" />
          <div x-data="{ signedName: '' }">
          <%= form_with url: accept_service_agreement_path(@acceptance.token), method: :post, local: true do |f| %>
            <div class="mb-4">
              <label for="agreement_signed_name" class="block text-sm font-medium text-gray-700">Type your legal name to sign</label>
              <input x-model="signedName" type="text" name="agreement[signed_name]" id="agreement_signed_name" placeholder="Type legal name to sign." class="mt-1 block w-full rounded-md border-gray-300 shadow-sm placeholder:text-gray-400 px-4 py-3 text-lg" required>
            </div>
            <div class="mb-6">
              <div class="text-xs uppercase tracking-wide text-gray-500">Signature preview</div>
              <div class="mt-2 text-3xl" style="font-family: 'Mr Dafoe', cursive"><span x-text="signedName || 'Your Name'"></span></div>
              <div class="mt-3 text-xs text-gray-600 space-y-1">
                <div>
                  <span class="font-medium text-gray-700">Date & time:</span>
                  <span><%= Time.current.strftime('%-d %b %Y %H:%M %Z') %></span>
                </div>
                <div>
                  <span class="font-medium text-gray-700">IP address:</span>
                  <span><%= request.remote_ip %></span>
                </div>
                <div>
                  <span class="font-medium text-gray-700">Content hash:</span>
                  <code class="text-gray-700"><%= @agreement.content_hash %></code>
                </div>
              </div>
            </div>
            <div class="flex items-center justify-between">
              <p class="text-xs text-gray-500">By clicking Accept, you agree to the terms above.</p>
              <%= f.submit "Accept", class: "px-4 py-2 rounded-lg bg-violet-600 text-white hover:bg-violet-700" %>
            </div>
          <% end %>
          </div>
        <% else %>
          <div class="mt-6 text-sm text-gray-600">
            Accepted by <strong><%= @acceptance.signed_name %></strong> on <%= @acceptance.signed_at.strftime('%-d %b %Y %H:%M %Z') %>
          </div>
        <% end %>
      </div>
    </div>
  </section>
  
</div>


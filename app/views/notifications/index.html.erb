<div class="max-w-5xl mx-auto p-6">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-semibold">Notifications</h1>
  </div>

  <% if @pending.any? %>
    <div class="overflow-hidden border border-gray-200 rounded-lg">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">User</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Period</th>
            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reason</th>
            <th class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
          </tr>
        </thead>
        <tbody class="bg-white divide-y divide-gray-200">
          <% @pending.each do |req| %>
            <tr id="<%= dom_id(req, :row) %>">
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                <%= req.user&.name || req.user&.email || "User ##{req.user_id}" %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-700">
                <% if req.starts_at.to_date == req.ends_at.to_date %>
                  <%= req.starts_at.strftime("%a, %d %b") %>:
                  <%= format_shift_time(req.starts_at) %> - <%= format_shift_time(req.ends_at) %>
                <% else %>
                  <%= req.starts_at.strftime("%a, %d %b") %> - <%= req.ends_at.strftime("%a, %d %b") %>
                <% end %>
                <% if req.repeats_weekly? %>
                  <span class="inline-block ml-2 align-middle text-gray-400" title="Repeats weekly">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3" />
                    </svg>
                  </span>
                <% end %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                <%= req.reason.presence || "—" %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-right text-sm">
                <div class="inline-flex gap-2">
                  
                  <%= button_to decline_unavailability_request_path(req, from: "notifications"),
                        method: :patch,
                        class: "flex items-start gap-3 p-3 rounded-2xl hover:bg-gray-50" do %>
                    <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-red-100 rounded-full">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                    </div>
                  <% end %>
                  
                  <%= button_to approve_unavailability_request_path(req, from: "notifications"),
                        method: :patch,
                        class: "flex items-start gap-3 p-3 rounded-2xl hover:bg-gray-50" do %>
                    <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-green-100 rounded-full">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                    </div>
                  <% end %>

                  
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
    <!-- Secondary view: condensed summaries -->
    <div class="mt-8 space-y-3">
      <% @pending.each do |req| %>
        <div class="flex items-start gap-3 p-4 rounded-3xl bg-white mb-4">
          <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full <%= req.repeats_weekly? ? 'bg-orange-100' : 'bg-violet-100' %>">
            <% if req.repeats_weekly? %>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-orange-600">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3" />
              </svg>
            <% else %>
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-violet-600">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0zM3.75 17.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0z" />
              </svg>
            <% end %>
          </div>
          <div class="min-w-0 text-sm text-gray-800">
            <% if req.repeats_weekly? %>
              <div>
                <strong><%= req.user&.name || req.user&.email || "User ##{req.user_id}" %></strong>
                has requested unavailability every <%= req.starts_at.strftime('%A') %>
                (<%= req.all_day? ? 'All Day' : "#{format_shift_time(req.starts_at)} - #{format_shift_time(req.ends_at)}" %>).
                <span class="text-gray-500">Reason:</span> <%= req.reason.presence || '—' %>
              </div>
            <% else %>
              <% days = (req.ends_at.to_date - req.starts_at.to_date).to_i + 1 %>
              <div>
                <strong><%= req.user&.name || req.user&.email || "User ##{req.user_id}" %></strong>
                has requested <%= days %> <%= 'day'.pluralize(days) %> off
                (<%= req.all_day? ? 'All Day' : "#{format_shift_time(req.starts_at)} - #{format_shift_time(req.ends_at)}" %>).
                <span class="text-gray-500">Reason:</span> <%= req.reason.presence || '—' %>
              </div>
            <% end %>
          </div>
         <div class="ml-auto flex gap-2">
                  
                  <%= button_to decline_unavailability_request_path(req, from: "notifications"),
                        method: :patch,
                        class: "flex items-start gap-3 p-3 rounded-2xl hover:bg-gray-50" do %>
                    <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-red-100 rounded-full">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                    </div>
                  <% end %>
                  
                  <%= button_to approve_unavailability_request_path(req, from: "notifications"),
                        method: :patch,
                        class: "flex items-start gap-3 p-3 rounded-2xl hover:bg-gray-50" do %>
                    <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-green-100 rounded-full">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                    </div>
                  <% end %>

                  
                </div>
        </div>
      <% end %>
    </div>
    <!-- Third view: table layout -->
    <div class="mt-8 overflow-hidden border border-gray-200 rounded-3xl">
      <table class="min-w-full">
        <tbody class="bg-white divide-y divide-gray-200">
          <% @pending.each do |req| %>
            <tr id="<%= dom_id(req, :table_row) %>">
              <!-- Column 1: icon -->
              <td class="px-4 py-3 w-12 align-top">
                <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full <%= req.repeats_weekly? ? 'bg-orange-100' : 'bg-violet-100' %>">
                  <% if req.repeats_weekly? %>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-orange-600">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 12c0-1.232-.046-2.453-.138-3.662a4.006 4.006 0 0 0-3.7-3.7 48.678 48.678 0 0 0-7.324 0 4.006 4.006 0 0 0-3.7 3.7c-.017.22-.032.441-.046.662M19.5 12l3-3m-3 3-3-3m-12 3c0 1.232.046 2.453.138 3.662a4.006 4.006 0 0 0 3.7 3.7 48.656 48.656 0 0 0 7.324 0 4.006 4.006 0 0 0 3.7-3.7c.017-.22.032-.441.046-.662M4.5 12l3 3m-3-3-3 3" />
                    </svg>
                  <% else %>
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-violet-600">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0zM3.75 17.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0z" />
                    </svg>
                  <% end %>
                </div>
              </td>
              <!-- Column 2: info -->
              <td class="px-4 py-3 align-top text-sm text-gray-800">
                <% if req.repeats_weekly? %>
                  <strong><%= req.user&.name || req.user&.email || "User ##{req.user_id}" %></strong>
                  has requested unavailability every <%= req.starts_at.strftime('%A') %>
                  (<%= req.all_day? ? 'All Day' : "#{format_shift_time(req.starts_at)} - #{format_shift_time(req.ends_at)}" %>).
                  <span class="text-gray-500">Reason:</span> <%= req.reason.presence || '—' %>
                <% else %>
                  <% days = (req.ends_at.to_date - req.starts_at.to_date).to_i + 1 %>
                  <strong><%= req.user&.name || req.user&.email || "User ##{req.user_id}" %></strong>
                  has requested <%= days %> <%= 'day'.pluralize(days) %> off
                  (<%= req.all_day? ? 'All Day' : "#{format_shift_time(req.starts_at)} - #{format_shift_time(req.ends_at)}" %>).
                  <span class="text-gray-500">Reason:</span> <%= req.reason.presence || '—' %>
                <% end %>
              </td>
              <!-- Column 3: actions -->
              <td class="px-4 py-3 text-right align-top">
                <div class="inline-flex gap-2">
                  <%= button_to decline_unavailability_request_path(req, from: "notifications"),
                        method: :patch,
                        class: "flex items-start gap-3 p-3 rounded-2xl hover:bg-gray-50" do %>
                    <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-red-100 rounded-full">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                    </div>
                  <% end %>
                  <%= button_to approve_unavailability_request_path(req, from: "notifications"),
                        method: :patch,
                        class: "flex items-start gap-3 p-3 rounded-2xl hover:bg-gray-50" do %>
                    <div class="flex-shrink-0 w-10 h-10 flex items-center justify-center bg-green-100 rounded-full">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                      </svg>
                    </div>
                  <% end %>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="bg-white border border-gray-200 rounded-lg p-8 text-center text-gray-500">
      No pending unavailability requests. 🎉
    </div>
  <% end %>
</div>
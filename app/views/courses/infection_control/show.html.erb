<div class="bg-zinc-100 min-h-screen py-10 px-4 sm:px-6 lg:px-8">
  <div class="max-w-3xl mx-auto space-y-8">
    <% if @step <= 8 %>
      <div class="bg-white rounded-3xl shadow-sm p-8">
        <p class="text-3xl"><%= @content[:emoji] %></p>
        <h1 class="text-2xl font-bold text-gray-900 mt-2"><%= @content[:title] %></h1>
        <p class="mt-3 text-sm text-violet-700 font-semibold">Objective</p>
        <p class="text-gray-600"><%= @content[:objective] %></p>

        <div class="mt-4 space-y-2 text-gray-700 leading-relaxed">
          <% @content[:paragraphs].each do |paragraph| %>
            <p><%= paragraph %></p>
          <% end %>
        </div>

        <% if @content[:activity].present? %>
          <div class="mt-6 bg-violet-50 border border-violet-100 rounded-2xl p-4">
            <p class="text-sm font-semibold text-violet-700">Activity</p>
            <p class="text-sm text-violet-900"><%= @content[:activity] %></p>
          </div>
        <% end %>

        <% if @content[:resource].present? %>
          <div class="mt-6 bg-blue-50 border border-blue-100 rounded-2xl p-4">
            <p class="text-sm font-semibold text-blue-700">Resource</p>
            <p class="text-sm text-blue-900"><%= @content[:resource] %></p>
          </div>
        <% end %>

        <div class="mt-8 flex justify-between">
          <% if @step > 1 %>
            <%= link_to 'Back', courses_infection_control_path(step: @step - 1), class: "text-sm text-gray-500" %>
          <% else %>
            <span></span>
          <% end %>
          <%= link_to 'Next', courses_infection_control_path(step: @step + 1), class: "inline-flex items-center px-5 py-2 bg-violet-600 hover:bg-violet-700 text-white rounded-3xl" %>
        </div>
      </div>
    <% elsif @step == 9 %>
      <div class="bg-white rounded-3xl shadow-sm p-8">
        <h1 class="text-2xl font-bold text-gray-900">Module 9: Assessment and Acknowledgement</h1>
        <p class="mt-2 text-gray-600">Answer all questions to complete the orientation. Aim for full marks.</p>

        <div class="mt-4">
          <%= link_to 'Back to Module 8', courses_infection_control_path(step: 8), class: "text-sm text-gray-500" %>
        </div>

        <%= form_with url: courses_infection_control_submit_quiz_path, method: :post, local: true, class: "mt-6 space-y-4" do |form| %>
          <% @questions.each_with_index do |question, idx| %>
            <div>
              <p class="text-sm font-medium text-gray-700 mb-2"><%= idx + 1 %>. <%= question[:prompt] %></p>
              <div class="space-y-2">
                <% question[:options].each do |option| %>
                  <label class="flex items-center gap-2 text-sm text-gray-700">
                    <%= radio_button_tag "quiz[q#{idx + 1}]", option[:value], params.dig(:quiz, "q#{idx + 1}") == option[:value], class: "text-violet-600 focus:ring-violet-500" %>
                    <span><%= option[:text] %></span>
                  </label>
                <% end %>
              </div>
            </div>
          <% end %>
          <div class="flex items-center gap-2 text-sm text-gray-600">
            <label class="inline-flex items-center">
              <%= form.check_box "quiz[acknowledgement]", { class: "mr-2" }, 'yes', 'no' %>
              <span>I acknowledge my responsibilities to maintain a safe environment.</span>
            </label>
          </div>
          <div class="pt-4">
            <%= form.submit 'Submit Quiz', class: "w-full bg-violet-600 hover:bg-violet-700 text-white font-semibold py-3 px-4 rounded-3xl" %>
          </div>
        <% end %>
      </div>
    <% else %>
      <% completion_date = @completion&.completed_at || Time.current %>

      <!-- Certificate Wrapper (A4-friendly width) -->
      <section class="w-full max-w-[210mm] mx-auto px-4 sm:px-6 lg:px-10 py-8 print:px-0 print:py-0">
        <div class="rounded-[34px] bg-gradient-to-r from-emerald-400 via-sky-400 to-indigo-500 p-[3px] shadow-2xl shadow-print print:shadow-none">
          <div class="rounded-[30px] bg-white px-8 py-10 md:px-12 md:py-14 print:px-10 print:py-12">
            <!-- Header / Logo row -->
            <div class="flex flex-col gap-6 sm:flex-row sm:items-start sm:justify-between">
              <div class="flex items-start gap-4">
                
                <div>
                  <p class="text-[11px] font-semibold uppercase tracking-[0.35em] text-slate-500">Provider</p>
                  <h2 class="text-lg font-semibold text-slate-800">Qcare QLD Pty Ltd</h2>
                  <p class="mt-1 text-xs text-slate-500">NDIS Support Workforce Training</p>
                </div>
              </div>
              <div class="rounded-2xl border border-slate-200/70 bg-slate-50/60 p-4 text-left text-xs text-slate-600 sm:text-right">
                <p class="font-semibold uppercase tracking-[0.3em] text-slate-500">Jurisdiction</p>
                <p class="mt-1 text-sm font-semibold text-slate-800">Queensland, Australia</p>
                <p class="mt-1 leading-relaxed">Aligned to Queensland Health and NDIS Practice Standards.</p>
              </div>
            </div>

            <!-- Title -->
            <header class="mt-12 text-center">
              <p class="text-xs font-semibold uppercase tracking-[0.35em] text-slate-500">Certificate of Completion</p>
              <h1 class="mt-4 text-3xl font-bold tracking-tight text-slate-900 md:text-4xl">
                Basics of Infection Prevention & Control (IPC)
              </h1>
              <p class="mt-3 text-sm text-slate-500">Orientation Course for NDIS Support Workers</p>
            </header>

            <!-- Recipient -->
            <section class="mt-12 text-center">
              <p class="text-xs uppercase tracking-[0.3em] text-slate-500">This certifies that</p>
              <div class="mt-4 flex justify-center">
                <span class="inline-flex min-w-[240px] max-w-full items-center justify-center rounded-2xl border border-slate-200 bg-slate-50 px-8 py-4 text-2xl font-semibold tracking-tight text-slate-900 md:text-3xl">
                  <%= current_user.name %>
                </span>
              </div>
              <p class="mx-auto mt-6 max-w-[70ch] text-sm leading-relaxed text-slate-600">
                has successfully completed the course requirements and demonstrated understanding of core infection
                prevention and control principles covering hand hygiene, personal protective equipment, environmental
                cleaning and disinfection, waste management, and incident escalation protocols.
              </p>
            </section>

            <!-- Details grid -->
            <section class="mt-12 grid grid-cols-1 gap-6 md:grid-cols-1">
              <div class="rounded-2xl border border-slate-200/80 bg-slate-50/40 p-6">
                <p class="text-[11px] font-semibold uppercase tracking-[0.35em] text-slate-500">Course Details</p>
                <dl class="mt-5 grid grid-cols-1 gap-y-4 text-sm sm:grid-cols-2">
                  <div>
                    <dt class="text-slate-500"></dt>
                    <dd class="mt-1 font-medium text-slate-800">Basics of Infection Prevention<br> &amp; Control (IPC)</dd>
                  </div>
                  <div>
                    <dt class="text-slate-500">Date Completed</dt>
                    <dd class="mt-1 font-medium text-slate-800"><%= l(completion_date.to_date, format: :long) %></dd>
                  </div>
                  <div>
                    
                  </div>
                  <div>
                   
                  </div>
                </dl>
              </div>
              <div class="rounded-2xl border border-slate-200/80 bg-slate-50/40 p-6">
                <p class="text-[11px] font-semibold uppercase tracking-[0.35em] text-slate-500">Certification</p>
                <dl class="mt-5 space-y-4 text-sm">
                  <div class="flex flex-col sm:flex-row sm:items-baseline sm:justify-between sm:gap-4">
                    <dt class="text-slate-500">Issued By</dt>
                    <dd class="mt-1 font-medium text-slate-800 sm:mt-0">Qcare QLD Pty Ltd · Authorised Manager</dd>
                  </div>
                  <div class="flex flex-col sm:flex-row sm:items-baseline sm:justify-between sm:gap-4">
                    <dt class="text-slate-500">Reference</dt>
                    <dd class="mt-1 font-medium text-slate-800 sm:mt-0">
                      <% reference = @completion&.id ? "QC-IPC-#{@completion.id.to_s.rjust(5, '0')}" : "QC-IPC-#{current_user.id}" %>
                      <%= reference %>
                    </dd>
                  </div>
                  <div class="flex flex-col sm:flex-row sm:items-baseline sm:justify-between sm:gap-4">
                    <dt class="text-slate-500">Review Cycle</dt>
                    <dd class="mt-1 font-medium text-slate-800 sm:mt-0">Recommended refresher 12 months</dd>
                  </div>
                </dl>
              </div>
            </section>

            <!-- Signatures -->
            <section class="mt-14 grid grid-cols-1 gap-12 md:grid-cols-2">
              <div>
                <div class="h-[42px] border-b border-dashed border-slate-300"></div>
                <p class="mt-6 text-sm font-medium text-slate-700">Ashley Knight</p>
                <p class="text-xs text-slate-500">Authorised Manager · Provider Representative</p>
              </div>
              <div>
                
            </section>

            <!-- Footer -->
            <footer class="mt-12 flex flex-col gap-4 text-xs leading-relaxed text-slate-500 md:flex-row md:items-center md:justify-between">
              <p class="max-w-[60ch]">
                This certificate confirms completion of internal training aligned to the NDIS Practice Standards and Queensland Health infection
                prevention and control guidance for frontline disability support services.
              </p>
              <p class="font-medium text-slate-400">Issue date: <%= l(completion_date.to_date, format: :long) %></p>
            </footer>
          </div>
        </div>
      </section>
        <div class="mt-6">
          <%= link_to 'Back to profile', user_path(current_user), class: "inline-flex items-center px-5 py-3 bg-violet-600 hover:bg-violet-700 text-white rounded-3xl" %>
        </div>
      </div>
    <% end %>
  </div>
</div>

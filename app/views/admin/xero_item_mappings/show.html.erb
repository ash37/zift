<!-- app/views/admin/xero_item_mappings/show.html.erb -->
<div class="bg-zinc-100 min-h-screen">
  <section class="container mx-auto px-4 py-10">
    <div class="w-full max-w-5xl mx-auto">

      <!-- Header / Actions -->
      <div class="bg-white rounded-2xl p-6 sm:p-8 flex items-center justify-between">
        <h1 class="text-2xl font-bold text-gray-800">Xero Item Mappings</h1>
        <%= button_to "Sync Invoice Items",
            sync_admin_xero_item_mappings_path,
            method: :post,
            class: "inline-flex items-center rounded-3xl bg-violet-600 text-white font-semibold px-4 py-2 hover:bg-violet-700 active:bg-violet-800 transition" %>
      </div>

      <!-- Mappings form -->
      <div class="mt-6 bg-white rounded-3xl p-6 sm:p-8">
        <%= form_with url: admin_xero_item_mappings_path, method: :put do %>

          <div class="space-y-4">
            <% @areas.each do |area| %>
              <div class="rounded-2xl border border-gray-200 p-5 sm:p-6 bg-white hover:bg-gray-50 transition">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 mb-4">
                  <p class="text-sm">
                    <span class="block text-xs uppercase tracking-wide text-gray-500">Client</span>
                    <span class="text-gray-900 font-medium"><%= area.location&.name.presence || "—" %></span>
                  </p>
                  <p class="text-sm">
                    <span class="block text-xs uppercase tracking-wide text-gray-500">Area</span>
                    <span class="text-gray-900 font-medium"><%= area.name %></span>
                  </p>
                  <p class="text-sm">
                    <span class="block text-xs uppercase tracking-wide text-gray-500">Current export_code</span>
                    <code class="text-gray-800 bg-gray-100 rounded px-2 py-0.5"><%= area.export_code.presence || "—" %></code>
                  </p>
                </div>

                <div>
                  <label class="block text-xs uppercase tracking-wide text-gray-500 mb-2">Map to Xero item</label>
                  <select
                    name="mappings[<%= area.id %>]"
                    class="form-select w-full rounded-xl border-gray-300 focus:border-violet-500 focus:ring-violet-500 p-3">
                    <option value=""></option>
                    <% @items.each do |it| %>
                      <% code = it[:code].to_s %>
                      <option value="<%= code %>" <%= "selected" if area.respond_to?(:xero_item_code) && area.xero_item_code == code %>>
                        <%= code %> — <%= it[:name] %>
                      </option>
                    <% end %>
                  </select>
                </div>
              </div>
            <% end %>
          </div>

          <div class="mt-6 flex justify-end">
            <%= submit_tag "Save mappings",
                class: "inline-flex items-center rounded-3xl bg-violet-600 text-white font-semibold px-6 py-2.5 hover:bg-violet-700 active:bg-violet-800 transition" %>
          </div>

        <% end %>
      </div>

    </div>
  </section>
</div>

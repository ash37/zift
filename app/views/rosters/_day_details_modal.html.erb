<%= turbo_frame_tag "assign_shift_modal" do %>
  <div class="fixed inset-0 w-full h-full bg-black/50 z-50" data-controller="modal" data-action="click->modal#close">
    <div class="relative absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-lg p-4 w-full max-w-lg" data-action="click->modal#stopClose">
      <div class="flex items-center justify-between mb-3">
        <h2 class="text-sm font-semibold text-gray-800">Shifts for <%= @user.first_name %> on <%= @day.strftime('%a %d %b') %></h2>
        <button type="button" data-action="click->modal#close" class="w-6 h-6 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" class="w-4 h-4 text-gray-600"><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>
        </button>
      </div>

      <% if @shifts_for_day.present? %>
        <div class="space-y-2"
             data-controller="drag"
             data-drag-enabled-value="<%= @roster.draft? %>"
             data-drag-url-value="/shifts/:id"
             data-drag-user-id-value="<%= @user.id %>"
             data-drag-date-value="<%= @day.to_s %>"
             data-drag-roster-id-value="<%= @roster.id %>">
          <% @shifts_for_day.each do |shift| %>
            <div class="w-full h-9">
              <%= render 'rosters/shift_pill', shift: shift, user: @user, date: @day, count_for_day: @shifts_for_day.size, selected_location_id: @selected_location_id, hover_controls: true %>
            </div>
          <% end %>
        </div>
      <% else %>
        <p class="text-xs text-gray-600 mb-3">No shifts scheduled.</p>
      <% end %>

      <div class="flex justify-end gap-2 mt-4">
        <%= link_to 'Add Shift', new_shift_path(user_id: @user.id, roster_id: @roster.id, date: @day, location_id: @selected_location_id), data: { turbo_frame: 'assign_shift_modal' }, class: 'px-3 py-1.5 rounded-3xl text-xs bg-violet-600 text-white hover:bg-violet-700' %>
        <button type="button" data-action="click->modal#close" class="px-3 py-1.5 rounded-3xl text-xs bg-gray-100 hover:bg-gray-200">Close</button>
      </div>
    </div>
  </div>
<% end %>

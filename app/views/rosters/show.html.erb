<h1 class="text-2xl font-bold mb-4">
  Roster: Week of <%= @roster.starts_on.strftime('%b %d, %Y') %>
</h1>

<p class="mb-4">
  Status:
  <span class="inline-block px-2 py-1 rounded text-white text-sm <%= @roster.draft? ? 'bg-yellow-500' : 'bg-green-600' %>">
    <%= @roster.status_label %>
  </span>
</p>

<% if @roster.draft? %>
  <div class="mb-6 flex gap-3">
    <%= button_to "Copy Previous Week", copy_previous_week_roster_path(@roster), method: :post, class: "bg-gray-200 hover:bg-gray-300 text-sm px-4 py-2 rounded-md" %>
    <%= button_to "Publish Roster", publish_roster_path(@roster), method: :post, class: "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm" %>
  </div>
<% end %>

<table class="w-full border border-gray-300 text-sm">
  <thead>
    <tr>
      <th class="bg-gray-100 text-left p-2 border border-gray-300">Employee</th>
      <% 7.times do |i| %>
        <th class="bg-gray-100 text-center p-2 border border-gray-300">
          <%= (@roster.starts_on + i.days).strftime("%a %d") %>
        </th>
      <% end %>
    </tr>
  </thead>

  <tbody>
    <% User.all.each do |user| %>
      <tr>
        <td class="font-medium p-2 border border-gray-300"><%= user.name %></td>
        <% 7.times do |i| %>
          <% date = @roster.starts_on + i.days %>
          <%# This cell is now much simpler. All the complex logic for what goes inside the cell
              has been moved to the _cell_content.html.erb partial. We removed the padding
              from this cell and let the partial handle its own layout. %>
          <td class="align-top p-0 border border-gray-300 hover:bg-gray-50 group relative min-h-[60px]">
            <%= render 'rosters/cell_content', roster: @roster, user: user, date: date %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>

<%# This frame will be used to load the 'new shift' modal %>
<turbo-frame id="assign_shift_modal"></turbo-frame>
